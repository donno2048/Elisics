<phyphox version="1.7" locale="en">
  <title>Magnetic Spectrum</title>
  <category>Tools</category>
  <icon format="base64">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
    </icon>
  <description>
            Display the frequency spectrum of data from the magnetometer.

            This experiment records data from the magnetometer and calculates its frequency spectrum through a Fourier transformation (FFT). The maximum detectable frequency depends on the maximum acquisition rate of your sensor.
    </description>
  <link label="Wiki">http://phyphox.org/wiki/index.php?title=Experiment:_Magnetic_Spectrum</link>
    <data-containers>
    <container size="4096">magInX</container>
    <container size="4096">magInY</container>
    <container size="4096">magInZ</container>
    <container size="4096">magX</container>
    <container size="4096">magY</container>
    <container size="4096">magZ</container>
    <container size="4096">time</container>
    <container size="4096">magX_subrange</container>
    <container size="4096">magY_subrange</container>
    <container size="4096">magZ_subrange</container>
    <container size="4096">time_subrange</container>
    <container size="1">recording_length</container>
    <container size="1">subrange_start</container>
    <container init="256">samples</container>
    <container size="1">actual_samples</container>
    <container size="1">actual_samples+1</container>
    <container size="1">period</container>
    <container size="1">count-1</container>
    <container size="1">count+1</container>
    <container size="1">count/2</container>
    <container size="1">count</container>
    <container size="1">t0</container>
    <container size="1">t1</container>
    <container size="1">Dt</container>
    <container size="1">dt</container>
    <container size="1">maxf</container>
    <container size="1">arate</container>
    <container size="4096">frequency</container>
    <container size="4096">fftXX</container>
    <container size="4096">fftYX</container>
    <container size="4096">fftZX</container>
    <container size="4096">fftXY</container>
    <container size="4096">fftYY</container>
    <container size="4096">fftZY</container>
    <container size="2048">halfFrequency</container>
    <container size="2048">halfFFTtempX</container>
    <container size="2048">halfFFTtempY</container>
    <container size="2048">halfFFTtempX2</container>
    <container size="2048">halfFFTtempY2</container>
    <container size="2048">fftX</container>
    <container size="2048">fftY</container>
    <container size="2048">fftZ</container>
    <container size="2048">fft2</container>
    <container size="2048">fft</container>
    <container size="0">f0</container>
    <container size="0">t</container>
    <container size="1">resolutionRatio</container>
    <container size="256">timeline</container>
    <container size="256">reducedf</container>
    <container size="256">reducedfft</container>
    <container size="1">firstfft</container>
    <container size="256">subf</container>
    <container size="256">subfft</container>
    <container size="32768">tmap</container>
    <container size="32768">fmap</container>
    <container size="32768">fftmap</container>
  </data-containers>
  <input>
    <sensor type="magnetic_field" rate="0">
      <output component="x">magInX</output>
      <output component="y">magInY</output>
      <output component="z">magInZ</output>
      <output component="t">time</output>
    </sensor>
  </input>
  <views>
    <view label="Spectrum">
      <value label="Peak-Frequency" unit="Hz">
        <input>f0</input>
      </value>
      <value label="Peak-Frequency" factor="60" unit="1/min">
        <input>f0</input>
      </value>
      <separator height="1"/>
      <graph label="Fourier Transform" logX="false" logY="true" labelX="Frequency" unitX="Hz" labelY="FFT Mag" unitY="a.u.">
        <input axis="x">halfFrequency</input>
        <input axis="y">fft</input>
      </graph>
      <separator height="1" precision="0"/>
      <value label="Samples used">
        <input>actual_samples</input>
      </value>
      <value label="Period used" unit="s" precision="2">
        <input>period</input>
      </value>
      <value label="Acquisition rate" unit="Hz" precision="0">
        <input>arate</input>
      </value>
      <value label="Nyquist frequency" unit="Hz" precision="0">
        <input>maxf</input>
      </value>
    </view>
    <view label="History">
      <graph label="Fourier Transform" logZ="true" labelX="Frequency" unitX="Hz" labelY="Time" unitY="s" labelZ="FFT Mag" unitZ="a.u." aspectRatio="1" style="map" mapWidth="256" partialUpdate="true">
        <input axis="x">fmap</input>
        <input axis="y">tmap</input>
        <input axis="z">fftmap</input>
      </graph>
      <graph label="History" labelX="Time" unitX="s" labelY="Peak-Frequency" unitY="Hz" partialUpdate="true" style="dots">
        <input axis="x">t</input>
        <input axis="y">f0</input>
      </graph>
    </view>
    <view label="Settings">
      <info label="Below you can set the number of samples used for the Fourier transform. More samples means slower updates, but higher spectral resolution."/>
      <value label="Samples" precision="0">
        <input>samples</input>
      </value>
      <separator height="0.5"/>
      <button label="128">
        <input type="value">128</input>
        <output>samples</output>
      </button>
      <button label="256">
        <input type="value">256</input>
        <output>samples</output>
      </button>
      <button label="512">
        <input type="value">512</input>
        <output>samples</output>
      </button>
      <button label="1024">
        <input type="value">1024</input>
        <output>samples</output>
      </button>
      <button label="2048">
        <input type="value">2048</input>
        <output>samples</output>
      </button>
      <button label="4096">
        <input type="value">4096</input>
        <output>samples</output>
      </button>
    </view>
    <view label="Raw data">
      <graph label="Magnetic field x" labelX="t" unitX="s" labelY="B" unitY="µT">
        <input axis="x">time_subrange</input>
        <input axis="y">magX_subrange</input>
      </graph>
      <graph label="Magnetic field y" labelX="t" unitX="s" labelY="B" unitY="µT">
        <input axis="x">time_subrange</input>
        <input axis="y">magY_subrange</input>
      </graph>
      <graph label="Magnetic field z" labelX="t" unitX="s" labelY="B" unitY="µT">
        <input axis="x">time_subrange</input>
        <input axis="y">magZ_subrange</input>
      </graph>
    </view>
  </views>
  <analysis sleep="0.1">
    <timer>
      <output clear="false">t</output>
    </timer>
    <const>
      <input as="value" clear="false">t</input>
      <input as="length" type="value">256</input>
      <output>timeline</output>
    </const>
    <append>
      <input>magInX</input>
      <output clear="false">magX</output>
    </append>
    <append>
      <input>magInY</input>
      <output clear="false">magY</output>
    </append>
    <append>
      <input>magInZ</input>
      <output clear="false">magZ</output>
    </append>
    <count>
      <input clear="false">magX</input>
      <output>count</output>
    </count>
    <subtract>
      <input clear="false">count</input>
      <input type="value">1</input>
      <output>count-1</output>
    </subtract>
    <first>
      <input clear="false">time</input>
      <output>t0</output>
    </first>
    <subrange>
      <input as="from" clear="false">count-1</input>
      <input as="length" type="value">1</input>
      <input as="in" clear="false">time</input>
      <output>t1</output>
    </subrange>
    <subtract>
      <input clear="false">t1</input>
      <input clear="false">t0</input>
      <output>Dt</output>
    </subtract>
    <divide>
      <input clear="false">Dt</input>
      <input clear="false">count-1</input>
      <output>dt</output>
    </divide>
    <count>
      <input clear="false">magX</input>
      <output>recording_length</output>
    </count>
    <subtract>
      <input>recording_length</input>
      <input clear="false">samples</input>
      <output>subrange_start</output>
    </subtract>
    <subrange>
      <input clear="false" as="from">subrange_start</input>
      <input as="in" clear="false">magX</input>
      <output>magX_subrange</output>
    </subrange>
    <subrange>
      <input clear="false" as="from">subrange_start</input>
      <input as="in" clear="false">magY</input>
      <output>magY_subrange</output>
    </subrange>
    <subrange>
      <input clear="false" as="from">subrange_start</input>
      <input as="in" clear="false">magZ</input>
      <output>magZ_subrange</output>
    </subrange>
    <subrange>
      <input clear="false" as="from">subrange_start</input>
      <input as="in" clear="false">time</input>
      <output>time_subrange</output>
    </subrange>
    <count>
      <input clear="false">magX_subrange</input>
      <output>actual_samples</output>
    </count>
    <add>
      <input clear="false">actual_samples</input>
      <input type="value">1</input>
      <output>actual_samples+1</output>
    </add>
    <multiply>
      <input clear="false">actual_samples</input>
      <input clear="false">dt</input>
      <output>period</output>
    </multiply>
    <fft>
      <input clear="false">magX_subrange</input>
      <output as="re">fftXX</output>
      <output as="im">fftXY</output>
    </fft>
    <fft>
      <input clear="false">magY_subrange</input>
      <output as="re">fftYX</output>
      <output as="im">fftYY</output>
    </fft>
    <fft>
      <input clear="false">magZ_subrange</input>
      <output as="re">fftZX</output>
      <output as="im">fftZY</output>
    </fft>
    <divide>
      <input clear="false">actual_samples</input>
      <input type="value">2</input>
      <output>count/2</output>
    </divide>
    <divide>
      <input type="value">0.5</input>
      <input clear="false">dt</input>
      <output>maxf</output>
    </divide>
    <divide>
      <input type="value">1</input>
      <input clear="false">dt</input>
      <output>arate</output>
    </divide>
    <ramp>
      <input as="start" type="value">0</input>
      <input as="stop" clear="false">arate</input>
      <input as="length" clear="false">actual_samples+1</input>
      <output>frequency</output>
    </ramp>
    <subrange>
      <input as="from" type="value">1</input>
      <input as="to" clear="false">count/2</input>
      <input as="in" clear="false">frequency</input>
      <input as="in">fftXX</input>
      <input as="in">fftXY</input>
      <output>halfFrequency</output>
      <output>halfFFTtempX</output>
      <output>halfFFTtempY</output>
    </subrange>
    <multiply>
      <input clear="false">halfFFTtempX</input>
      <input>halfFFTtempX</input>
      <output>halfFFTtempX2</output>
    </multiply>
    <multiply>
      <input clear="false">halfFFTtempY</input>
      <input>halfFFTtempY</input>
      <output>halfFFTtempY2</output>
    </multiply>
    <add>
      <input>halfFFTtempX2</input>
      <input>halfFFTtempY2</input>
      <output>fftX</output>
    </add>
    <subrange>
      <input as="from" type="value">1</input>
      <input as="to" clear="false">count/2</input>
      <input as="in" clear="false">frequency</input>
      <input as="in">fftYX</input>
      <input as="in">fftYY</input>
      <output>halfFrequency</output>
      <output>halfFFTtempX</output>
      <output>halfFFTtempY</output>
    </subrange>
    <multiply>
      <input clear="false">halfFFTtempX</input>
      <input>halfFFTtempX</input>
      <output>halfFFTtempX2</output>
    </multiply>
    <multiply>
      <input clear="false">halfFFTtempY</input>
      <input>halfFFTtempY</input>
      <output>halfFFTtempY2</output>
    </multiply>
    <add>
      <input>halfFFTtempX2</input>
      <input>halfFFTtempY2</input>
      <output>fftY</output>
    </add>
    <subrange>
      <input as="from" type="value">1</input>
      <input as="to" clear="false">count/2</input>
      <input as="in" clear="false">frequency</input>
      <input as="in">fftZX</input>
      <input as="in">fftZY</input>
      <output>halfFrequency</output>
      <output>halfFFTtempX</output>
      <output>halfFFTtempY</output>
    </subrange>
    <multiply>
      <input clear="false">halfFFTtempX</input>
      <input>halfFFTtempX</input>
      <output>halfFFTtempX2</output>
    </multiply>
    <multiply>
      <input clear="false">halfFFTtempY</input>
      <input>halfFFTtempY</input>
      <output>halfFFTtempY2</output>
    </multiply>
    <add>
      <input>halfFFTtempX2</input>
      <input>halfFFTtempY2</input>
      <output>fftZ</output>
    </add>
    <add>
      <input>fftX</input>
      <input>fftY</input>
      <input>fftZ</input>
      <output>fft2</output>
    </add>
    <power>
      <input as="base">fft2</input>
      <input as="exponent" type="value">0.5</input>
      <output>fft</output>
    </power>
    <max>
      <input as="y" clear="false">fft</input>
      <input as="x" clear="false">halfFrequency</input>
      <output as="position" clear="false">f0</output>
    </max>
    <divide>
      <input clear="false">actual_samples</input>
      <input type="value">512</input>
      <output>resolutionRatio</output>
    </divide>
    <reduce averageY="true" averageX="false">
      <input clear="false" as="factor">resolutionRatio</input>
      <input clear="false" as="x">halfFrequency</input>
      <input clear="false" as="y">fft</input>
      <output as="x" clear="true">reducedf</output>
      <output as="y" clear="true">reducedfft</output>
    </reduce>
    <const>
      <output>subf</output>
    </const>
    <first>
      <input clear="false">reducedfft</input>
      <output>firstfft</output>
    </first>
    <const>
      <input as="value">firstfft</input>
      <output>subfft</output>
    </const>
    <subrange>
      <input as="from" type="value">0</input>
      <input as="to" type="value">256</input>
      <input as="in">reducedf</input>
      <input as="in">reducedfft</input>
      <output clear="false">subf</output>
      <output clear="false">subfft</output>
    </subrange>
    <append>
      <input clear="false">timeline</input>
      <output clear="false">tmap</output>
    </append>
    <append>
      <input clear="false">subf</input>
      <output clear="false">fmap</output>
    </append>
    <append>
      <input clear="false">subfft</input>
      <output clear="false">fftmap</output>
    </append>
  </analysis>
  <export>
    <set name="FFT Spectrum">
      <data name="Frequency (Hz)">halfFrequency</data>
      <data name="Absolute Amplitude (a.u.)">fft</data>
    </set>
    <set name="Peak History">
      <data name="Time (s)">t</data>
      <data name="Peak-Frequency">f0</data>
    </set>
    <set name="Raw data">
      <data name="Time (s)">time_subrange</data>
      <data name="Magnetic field x (µT)">magX_subrange</data>
      <data name="Magnetic field y (µT)">magY_subrange</data>
      <data name="Magnetic field z (µT)">magZ_subrange</data>
    </set>
  </export>
</phyphox>
